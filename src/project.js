require=function e(t,i,n){function o(s,a){if(!i[s]){if(!t[s]){var r="function"==typeof require&&require;if(!a&&r)return r(s,!0);if(c)return c(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=i[s]={exports:{}};t[s][0].call(l.exports,function(e){var i=t[s][1][e];return o(i?i:e)},l,l.exports,e,t,i,n)}return i[s].exports}for(var c="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({AdaptationScene:[function(e,t,i){"use strict";cc._RFpush(t,"c89e9CN7ZhK3Kd9QxI92LjU","AdaptationScene"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){var e=cc.director.getWinSize(),t=this.node.getComponent(cc.Canvas),i=cc.visibleRect.width,n=cc.visibleRect.height;i/960>n/640?(t.fitWidth=!1,t.fitHeight=!0,this.canvasFitType="fitHeight",this.canvasScale=cc.visibleRect.width/960):(cc.log("width"),t.fitWidth=!0,t.fitHeight=!1,this.canvasFitType="fitWidth",this.canvasScale=cc.visibleRect.height/640),cc.log("cc.visibleRect",cc.visibleRect),cc.log("winSize",e)}}),cc._RFpop()},{}],background:[function(e,t,i){"use strict";cc._RFpush(t,"b31afV/eaZB/YRqdPj4zB0C","background");var n=cc.Enum({GROUND_MOVE_INTERVAL:.05,GROUND_VX:-5});cc.Class({"extends":cc.Component,properties:{groundNode:{"default":[],type:[cc.Node]},groundImg:{"default":null,type:cc.Sprite}},onLoad:function(){var e=cc.winSize;this.winSizeHeight=e.height,cc.log("_size",e,this.winSizeHeight),this._height=this.groundImg.node.height,cc.log("this._height",this._height),this.schedule(this.onGroundMove,n.GROUND_MOVE_INTERVAL)},onGroundMove:function(){this.groundNode[0].y+=n.GROUND_VX,this.groundNode[1].y+=n.GROUND_VX,this.groundNode[0].y+this._height/2<-this.winSizeHeight/2&&(this.groundNode[0].y=this.groundNode[1].y+this._height),this.groundNode[1].y+this._height/2<-this.winSizeHeight/2&&(this.groundNode[1].y=this.groundNode[0].y+this._height)}});cc._RFpop()},{}],bulletGroup:[function(e,t,i){"use strict";cc._RFpush(t,"3d2d93zegRMeaoaPHxucDMn","bulletGroup");var n=cc.Class({name:"bPosition",properties:{xAxis:{"default":"",tooltip:"初始x轴，相对hero"},yAxis:{"default":"",tooltip:"初始y轴，相对hero"}}}),o=cc.Class({name:"bulletInfinite",properties:{name:"bullet",freqTime:0,initPollCount:0,prefab:cc.Prefab,position:{"default":[],type:n,tooltip:"每次多少排子弹"}}}),c=cc.Class({name:"bulletFiniteG","extends":o,properties:{orginName:"",finiteTime:0}});cc.Class({"extends":cc.Component,properties:function(){return{bulletInfinite:{"default":null,type:o,tooltip:"无限时长子弹组"},bulletFiniteG:{"default":[],type:c,tooltip:"有限时长子弹组"},hero:cc.Node}},onLoad:function(){this.eState=D.commonInfo.gameState.none,D.common.createPool({name:this.bulletInfinite.name+"Pool",mediator:"bullet",prefab:this.bulletInfinite.prefab,initCount:20}),D.common.createPool({name:this.bulletFiniteG[0].name+"Pool",mediator:"bullet",prefab:this.bulletFiniteG[0].prefab,initCount:20})},pauseAction:function(){this.enabled=!1,this.eState=D.commonInfo.gameState.pause},resumeAction:function(){this.enabled=!0,this.eState=D.commonInfo.gameState.start},startAction:function(){this.eState=D.commonInfo.gameState.start,this.getNewbullet(this.bulletInfinite),this.bICallback=function(){this.getNewbullet(this.bulletInfinite)}.bind(this),this.schedule(this.bICallback,this.bulletInfinite.freqTime)},changeBullet:function(e){this.unschedule(this.bICallback),this.unschedule(this.bFCallback);for(var t=0;t<this.bulletFiniteG.length;t++)if(this.bulletFiniteG[t].orginName==e){this.bFCallback=function(e){this.getNewbullet(this.bulletFiniteG[e])}.bind(this,t),this.schedule(this.bFCallback,this.bulletFiniteG[t].freqTime,this.bulletFiniteG[t].finiteTime);var i=this.bulletFiniteG[t].freqTime*this.bulletFiniteG[t].finiteTime;this.schedule(this.bICallback,this.bulletInfinite.freqTime,cc.macro.REPEAT_FOREVER,i)}},getNewbullet:function(e){for(var t=e.name+"Pool",i=0;i<e.position.length;i++){var n=D.common.getPoolObj(t),o=this.getBulletPostion(e.position[i]);n.setPosition(o),n.getComponent("bullet").bulletGroup=this,n.getComponent("bullet").bulletPoolName=t,this.node.addChild(n)}},getBulletPostion:function(e){if(!this.hero)return cc.log("hero不存在的",this.hero);var t=this.hero.getPosition(),i=parseInt(e.xAxis),n=parseInt(e.yAxis);i>0?i-=this.hero.width/2:i<0&&(i=this.hero.width/2+i);var o=t.x+i,c=t.y+n;return cc.p(o,c)},bulletDied:function(e,t){D.common.putPoolObj(t,e)}}),cc._RFpop()},{}],bullet:[function(e,t,i){"use strict";cc._RFpush(t,"81be82YwS9L1LZYufVXSrCP","bullet"),cc.Class({"extends":cc.Component,properties:{xSpeed:cc.Integer,ySpeed:cc.Integer,hpDrop:cc.Integer},onLoad:function(){cc.director.getCollisionManager().enabled=!0},onCollisionEnter:function(e,t){this.bulletGroup.bulletDied(t.node,this.bulletPoolName)},update:function(e){this.bulletGroup.eState==D.commonInfo.gameState.start&&(this.node.x+=e*this.xSpeed,this.node.y+=e*this.ySpeed,this.node.y>this.node.parent.height&&this.bulletGroup.bulletDied(this.node,this.bulletPoolName))}}),cc._RFpop()},{}],common:[function(e,t,i){"use strict";cc._RFpush(t,"67917VzMgFG4LdHbqjwaGkY","common");var n=cc.Enum({none:0,start:1,stop:2}),o=cc.Class({"extends":cc.Component,properties:{pools:{"default":{}}},statics:{gameState:n},onLoad:function(){D.commonInfo=o,D.common=this},createPool:function(e){if(cc.assert(e.prefab,"没有传入对像池的prefab"),!this.pools[e.name]){cc.log("createPool",e.name,"start");for(var t=e.mediator||"",i=new cc.NodePool(t),n=e.initCount||1,o=0;o<n;++o){var c=cc.instantiate(e.prefab);i.put(c)}e.pool=i,this.pools[e.name]=e}},getPoolObj:function(e,t){if(cc.assert(this.pools[e],"getPoolObj 该对像池不存在:"+e),0==this.pools[e].pool.size()){var i=cc.instantiate(this.pools[e].prefab);this.pools[e].pool.put(i)}return this.pools[e].pool.get(t)},putPoolObj:function(e,t){cc.assert(this.pools[e],"putPoolObj 该对像池不存在:"+e),this.pools[e].pool.put(t)},timeFmt:function(e,t){var i={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var n in i)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?i[n]:("00"+i[n]).substr((""+i[n]).length)));return t}});cc._RFpop()},{}],end:[function(e,t,i){"use strict";cc._RFpush(t,"c597br4kitB+7t22tMQBl2k","end"),cc.Class({"extends":cc.Component,properties:{topScore:cc.Label,currentScore:cc.Label,rankPrefab:cc.Prefab,gameOverClip:cc.AudioClip},onLoad:function(){cc.director.isPaused()&&cc.director.resume(),D.isOnSound&&cc.audioEngine.playEffect(this.gameOverClip,!1);var e=cc.sys.localStorage.getItem("topScore");if(this.topScore.string="历史最高纪录:\n"+e,0==D.curStage){var t=cc.sys.localStorage.getItem("currentScore");this.currentScore.string="当前得分:\n"+t}else this.currentScore.string="当前得分:\n"+D.curScore;cc.director.preloadScene("main")},gameRestart:function(){cc.director.loadScene("main")},gameExit:function(){cc.director.loadScene("start")},gotoHistoryScore:function(){var e=cc.instantiate(this.rankPrefab);this.node.addChild(e)}}),cc._RFpop()},{}],enemyBulletGroup:[function(e,t,i){"use strict";cc._RFpush(t,"323ebEQHitGdJF0u2YtEUwa","enemyBulletGroup");var n=cc.Class({name:"e_bPosition",properties:{xAxis:{"default":"",tooltip:"初始x轴，相对hero"},yAxis:{"default":"",tooltip:"初始y轴，相对hero"}}}),o=cc.Class({name:"e_bulletInfinite",properties:{name:"",freqTime:0,initPollCount:0,prefab:cc.Prefab,position:{"default":[],type:n,tooltip:"每次多少排子弹"}}});cc.Class({"extends":cc.Component,properties:function(){return{e_bulletInfinite:{"default":[],type:o,tooltip:"无限时长子弹组"}}},onLoad:function(){cc.log("enemyBulletGroup : onLoad"),this.eState=D.commonInfo.gameState.none,D.common.createPool({name:"enemyBulletPool",mediator:"enemyBullet",prefab:this.e_bulletInfinite[0].prefab,initCount:20}),this.startAction()},startAction:function(){this.eState=D.commonInfo.gameState.start,this.getNewbullet(),this.schedule(this.getNewbullet,this.e_bulletInfinite[0].freqTime)},getNewbullet:function(){for(var e=this.e_bulletInfinite[0],t="enemyBulletPool",i=0;i<e.position.length;i++){var n=D.common.getPoolObj(t),o=this.getBulletPostion(e.position[i]);n.setPosition(o),n.getComponent("enemyBullet").setEnemyBulletGroup(this),this.node.addChild(n)}},getBulletPostion:function(e){var t=this.node.getPosition(),i=t.x+parseInt(e.xAxis),n=t.y+parseInt(e.yAxis);return cc.p(i,n)},bulletDied:function(e){D.common.putPoolObj("enemyBulletPool",e)}}),cc._RFpop()},{}],enemyBullet:[function(e,t,i){"use strict";cc._RFpush(t,"88d3eoMDltBB6Rd3icdf35d","enemyBullet"),cc.Class({"extends":cc.Component,properties:{xSpeed:{"default":0,type:cc.Integer},ySpeed:{"default":100,type:cc.Integer},hpDrop:{"default":1,type:cc.Integer},hitBoomSpr:cc.SpriteFrame,enemyBulletBoomClip:cc.AudioClip},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.isBoom=!1},setEnemyBulletGroup:function(e){this.enemyName=e.name,this.id=e.id},onCollisionEnter:function(e,t){this.isBoom||this.onBoom(t.node)},update:function(e){this.isBoom||(this.node.y-=e*this.ySpeed,this.node.y<-1e3&&D.common.putPoolObj("enemyBulletPool",this.node))},onBoom:function(e){this.enemyBulletBoomClip&&D.isOnSound&&cc.audioEngine.playEffect(this.enemyBulletBoomClip,!1),this.isBoom=!0,e.getComponent(cc.Sprite).spriteFrame=this.hitBoomSpr;var t=cc.sequence(cc.spawn(cc.scaleBy(.3,2),cc.fadeOut(.3)),cc.callFunc(function(){e.destroy()}));e.runAction(t)},onDestroy:function(){cc.log("onDestroy")}}),cc._RFpop()},{}],enemyGroup:[function(e,t,i){"use strict";cc._RFpush(t,"703caNdSJBMG5jxYvPFwWvP","enemyGroup");var n=cc.Class({name:"enemyG",properties:{name:"",freqTime:0,initPollCount:0,prefab:cc.Prefab}});cc.Class({"extends":cc.Component,properties:function(){return{enemyG:{"default":[],type:n},main:{"default":null,type:e("main")},enemyPre:{"default":[],type:cc.Prefab}}},onLoad:function(){cc.log("enemyGroup",this.enemyG),this.eState=D.commonInfo.gameState.none,this.initLevelMode();for(var e in this.enemyG)D.common.createPool({name:this.enemyG[e].name+"Pool",mediator:"enemy",prefab:this.enemyG[e].prefab,initCount:this.enemyG[e].initPollCount})},initLevelMode:function(){cc.log("D.curStage = ",D.curStage),1==D.curStage?this.enemyG=[{name:"enemy1",freqTime:2,initPollCount:20,prefab:this.enemyPre[0]},{name:"enemy4",freqTime:1,initPollCount:20,prefab:this.enemyPre[3]}]:2==D.curStage?this.enemyG=[{name:"enemy1",freqTime:2,initPollCount:20,prefab:this.enemyPre[0]},{name:"enemy2",freqTime:5,initPollCount:20,prefab:this.enemyPre[1]}]:3==D.curStage&&(this.enemyG=[{name:"enemy2",freqTime:2,initPollCount:20,prefab:this.enemyPre[1]},{name:"enemy3",freqTime:5,initPollCount:20,prefab:this.enemyPre[2]}])},startAction:function(){this.eState=D.commonInfo.gameState.start;for(var e=0;e<this.enemyG.length;++e){var t=this.enemyG[e].freqTime;this.schedule(function(e){this.getNewEnemy(this.enemyG[e])}.bind(this,e),t)}},resumeAction:function(){this.enabled=!0,this.eState=D.commonInfo.gameState.start},pauseAction:function(){this.enabled=!1,this.eState=D.commonInfo.gameState.pause},getNewEnemy:function(e){var t=e.name+"Pool",i=D.common.getPoolObj(t);if(i){var n=this.getNewEnemyPositon(i);i.setPosition(n),i.getComponent("enemy").init(),i.getComponent("enemy").enemyPoolName=t,this.node.addChild(i)}},getNewEnemyPositon:function(e){var t=cc.randomMinus1To1()*(this.node.parent.width/2-e.width/2),i=this.node.parent.height/2+e.height/2;return cc.v2(t,i)},enemyDied:function(e,t,i){D.common.putPoolObj(i,e),parseInt(t)>0&&this.main.gainScore(t)},getScore:function(){return this.main.getScore()}}),cc._RFpop()},{main:"main"}],enemy:[function(e,t,i){"use strict";cc._RFpush(t,"14abee9CoxCobWl/nmeEUv8","enemy"),cc.Class({"extends":cc.Component,properties:{xMinSpeed:{"default":0,type:cc.Integer,tooltip:"x轴最小速度"},xMaxSpeed:{"default":0,type:cc.Integer,tooltip:"x轴最大速度"},yMinSpeed:{"default":0,type:cc.Integer,tooltip:"y轴最小速度"},yMaxSpeed:{"default":0,type:cc.Integer,tooltip:"y轴最大速度"},initHP:{"default":0,type:cc.Integer,tooltip:"初始生命值"},initSpriteFrame:{"default":null,type:cc.SpriteFrame,tooltip:"初始化的图像"},score:{"default":0,type:cc.Integer,tooltip:"死后获得的分数"},bulletPre:{"default":null,type:cc.Prefab},enemyDownClip:cc.AudioClip},onLoad:function(){console.log("enemy onload"),cc.director.getCollisionManager().enabled=!0,this.xSpeed=Math.random()*(this.xMaxSpeed-this.xMinSpeed)+this.xMinSpeed,this.ySpeed=cc.random0To1()*(this.yMaxSpeed-this.yMinSpeed)+this.yMinSpeed,this.enemyGroup=this.node.parent.getComponent("enemyGroup"),"enemy1"!=this.node.name&&"enemy2"!=this.node.name||this.startShooting()},startShooting:function(){D.common.createPool({name:"enemyBulletPool",mediator:"enemyBullet",prefab:this.bulletPre,initCount:10}),this.schedule(this.addBullet,1)},addBullet:function(){var e=D.common.getPoolObj("enemyBulletPool");e.getComponent("enemyBullet").setEnemyBulletGroup({id:this.node.__instanceId,name:this.node.name}),e.parent=this.node.parent,e.position=cc.p(this.node.x,this.node.y-this.node.height/2)},init:function(){if("enemy"!=this.node.group&&(this.node.group="enemy"),this.hP!=this.initHP&&(this.hP=this.initHP),this.initSpriteFrame){var e=this.node.getComponent(cc.Sprite);e&&e.spriteFrame!=this.initSpriteFrame&&(e.spriteFrame=this.initSpriteFrame)}},update:function(e){if(this.enemyGroup.eState==D.commonInfo.gameState.start){var t=this.enemyGroup.getScore();t<=5e4?this.node.y+=e*this.ySpeed:t>5e4&&t<=1e5?this.node.y+=e*this.ySpeed-.5:t>1e5&&t<=15e4?this.node.y+=e*this.ySpeed-1:t>15e4&&t<=2e5?this.node.y+=e*this.ySpeed-1.5:t>2e5&&t<=3e5?this.node.y+=e*this.ySpeed-2:this.node.y+=e*this.ySpeed-3,this.node.x+=e*this.xSpeed,this.node.y<-this.node.parent.height/2&&this.enemyGroup.enemyDied(this.node,0,this.enemyPoolName)}},onCollisionEnter:function(e,t){if(!(this.hP<=0)){if("bomb"==e.node.group||"hero"==e.node.group)this.hP-=50;else if("bullet"==e.node.group){var i=e.node.getComponent("bullet");this.hP-=i.hpDrop}this.hP<=0&&this.onBoom(t)}},onFinished:function(e){this.enemyGroup.enemyDied(this.node,this.score,this.enemyPoolName)},onBoom:function(e){if(!this.enemyDownClip)return this.onFinished();var t=this.getComponent(cc.Animation),i="explosionAni";t.play(i),t.on("finished",this.onFinished,this),D.isOnSound&&cc.audioEngine.playEffect(this.enemyDownClip,!1)}}),cc._RFpop()},{}],globals:[function(e,t,i){"use strict";cc._RFpush(t,"2db22ldw1ZEWKAUUhqzblk7","globals"),window.D={common:null,commonInfo:null,curStage:0,curScore:0,isOnBgm:!0,isOnSound:!0,curDifficult:.5,stage:{1:{scoreMax:3e3},2:{scoreMax:6e3},3:{scoreMax:1e4}}},cc._RFpop()},{}],hero:[function(e,t,i){"use strict";cc._RFpush(t,"3f0ccHUefxOLK9+K5/zp2v4","hero"),cc.Class({"extends":cc.Component,properties:function(){return{gameOverClip:cc.AudioClip,explodeClip:cc.AudioClip,main:{"default":null,type:e("main")},bulletGroup:{"default":null,type:e("bulletGroup")},stateLabel:{"default":null,type:cc.Label},buff_2Clip:cc.AudioClip}},onLoad:function(){this.eState=D.commonInfo.gameState.none,cc.director.getCollisionManager().enabled=!0,this.onDrag(),this.hpMax=3,this.hp=3,this.invincible=!1,this.reverse=1,this.isDeath=!1},onDrag:function(){this.node.on("touchmove",this.dragMove,this)},offDrag:function(){this.node.off("touchmove",this.dragMove,this)},dragMove:function(e){if(cc.director.isPaused())return!1;if(this.isDeath)return!1;var t=e.getLocation(),i=this.node.parent.convertToNodeSpaceAR(t),n=-this.node.parent.width/2+this.node.width/2,o=-n,c=-this.node.parent.height/2+this.node.height/2,s=-c;i.x<n&&(i.x=n),i.x>o&&(i.x=o),i.y<c&&(i.y=c),i.y>s&&(i.y=s),this.reverse==-1&&(i.x=i.x*this.reverse),this.node.setPosition(i)},onCollisionEnter:function(e,t){this.isDeath||("ufo"==e.node.group?"ufoBullet"==e.node.name?this.bulletGroup.changeBullet(e.node.name):"ufoBomb"==e.node.name?this.main.getUfoBomb():"ufoRandom"==e.node.name&&this.setRandomState():"enemy"==e.node.group||"enemyBullet"==e.node.group?this.onDeath():cc.log("hero碰到了啥?",e.node.group))},setRandomState:function(){var e=5,t=parseInt(Math.random()*e+1);if(cc.log("tempRandom",t),1==t)cc.log("开启无敌"),this.unschedule(this.onInvincibleBuff),this.invincible=!0,this.stateLabel.string="无敌",this.scheduleOnce(this.onInvincibleBuff,5);else if(2==t){if(cc.log("加血"),this.hp>=this.hpMax)return;D.isOnSound&&cc.audioEngine.playEffect(this.buff_2Clip,!1),this.hp++,this.main.setHeroHpLabel(this.hp)}else 3==t?(cc.log("扣血"),this.onDeath()):4==t?(cc.log("反向"),this.unschedule(this.onReverseDeBuff),this.reverse=-1,this.stateLabel.string="左右反向",this.scheduleOnce(this.onReverseDeBuff,3)):5==t&&(cc.log("放大"),this.unschedule(this.onEnlargedeBuff),this.node.setScale(1.5),this.stateLabel.string="体积变大",this.scheduleOnce(this.onEnlargedeBuff,3))},onInvincibleBuff:function(){cc.log("关闭无敌"),this.stateLabel.string="",this.invincible=!1},onEnlargedeBuff:function(){cc.log("关闭放大"),this.stateLabel.string="",this.node.setScale(1)},onReverseDeBuff:function(){cc.log("关闭反向"),this.stateLabel.string="",this.reverse=1},onDeath:function(){if(D.isOnSound&&cc.audioEngine.playEffect(this.explodeClip,!1),this.invincible)return!1;if(this.hp--,this.main.setHeroHpLabel(this.hp),this.hp>0)return!1;this.isDeath=!0,D.isOnSound&&cc.audioEngine.playEffect(this.gameOverClip,!1);var e=this.getComponent(cc.Animation),t=e.getClips();e.play(t[0].name),e.on("finished",this.onFinished,this)},onFinished:function(){this.node.destroy(),this.main.gameOver()}}),cc._RFpop()},{bulletGroup:"bulletGroup",main:"main"}],historyScore:[function(e,t,i){"use strict";cc._RFpush(t,"c11abrWZANO2aVZSE4dxEvW","historyScore"),cc.Class({"extends":cc.Component,properties:{itemPrefab:cc.Prefab,scrollContent:cc.Node,backGameBtn:cc.Node},onLoad:function(){var e=JSON.parse(cc.sys.localStorage.getItem("score"));if(e){var t=this.getSortList(e);for(var i in t){var n=cc.instantiate(this.itemPrefab),o=parseInt(i)+1,c=t[i];if(this.scrollContent.addChild(n),n.getComponent("scoreItemTemplate").init({rank:o,score:c.score,time:c.time}),o>9)return}}},getSortList:function(e){var t=[],i=function(i){e.sort(function(e,t){return parseInt(t[i])-parseInt(e[i])==0?parseInt(t.score)-parseInt(e.score):parseInt(t[i])-parseInt(e[i])});for(var n in e)t.push(e[n])};return i("score"),t},onBackGameBtnTap:function(){this.node.destroy()}}),cc._RFpop()},{}],levelView:[function(e,t,i){"use strict";cc._RFpush(t,"cf855nsu/9Ok534fwSrZzsF","levelView"),cc.Class({"extends":cc.Component,properties:{main:cc.Node},onLoad:function(){this.onTouchEvent()},onLevel_1_BtnTap:function(){this.gotoGameMain(1)},onLevel_2_BtnTap:function(){this.gotoGameMain(2)},onLevel_3_BtnTap:function(){this.gotoGameMain(3)},gotoGameMain:function(e){D.curStage=e,cc.director.loadScene("main")},onTouchEvent:function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(t){return t.stopPropagation(),e.node.destroy(),!0},this.node),this.main.on(cc.Node.EventType.TOUCH_START,function(e){return e.stopPropagation(),!0},this)}}),cc._RFpop()},{}],main:[function(e,t,i){"use strict";cc._RFpush(t,"6afa0phF7dPka/zlZtFFHow","main"),cc.Class({"extends":cc.Component,properties:function(){return{pause:cc.Button,btnSprite:{"default":[],type:cc.SpriteFrame,tooltip:"暂停按钮不同状态的图片"},bomb:cc.Node,gameMusic:{"default":null,type:cc.AudioSource},gameStartSound:{"default":null,type:cc.AudioSource},useBombClip:cc.AudioClip,enemyGroup:{"default":null,type:e("enemyGroup")},hero:{"default":null,type:e("hero")},ufoGroup:{"default":null,type:e("ufoGroup")},bulletGroup:{"default":null,type:e("bulletGroup")},scoreDisplay:cc.Label,bombNoDisplay:cc.Label,bombMash:cc.Node,stageTextLabel:cc.Label,bgSprNode:cc.Node,curStageLabel:cc.Label,heroHpLabel:cc.Label,pausedlPrefab:cc.Prefab,mianNode:cc.Node,scoreMaxLabel:cc.Label}},onLoad:function(){cc.log("main : onLoad"),this.bomb.on("touchstart",this.onBombBtnTap,this),D.isOnBgm&&this.gameMusic.play(),D.isOnSound||(this.gameStartSound.mute=!0),cc.director.isPaused()&&this.resumeAction(),this.initData()},initData:function(){this.score=0,this.bombNo=0,D.curScore=0,this.scoreDisplay.string=this.score,this.bombNoDisplay.string=this.bombNo,this.eState=D.commonInfo.gameState.start;var e=D.curStage;cc.log("curStage",e),e?(this.curStageLabel.string="当前关卡：第"+e+"关",this.scoreMaxLabel.node.active=!0,this.scoreMaxLabel.string="通关所需分数:"+parseInt(D.stage[D.curStage].scoreMax*D.curDifficult)):this.curStageLabel.string="积分模式",this.enemyGroup.startAction(),this.bulletGroup.startAction(),this.ufoGroup.startAction()},setHeroHpLabel:function(e){0==e?this.heroHpLabel.string="♡♡♡":1==e?this.heroHpLabel.string="♥♡♡":2==e?this.heroHpLabel.string="♥♥♡":this.heroHpLabel.string="♥♥♥"},onBombBtnTap:function(){if(!this.bombMash.active){var e=this.bomb.getChildByName("bombNo").getComponent(cc.Label),t=parseInt(e.string);t>0?(e.string=t-1,this.removeEnemy()):cc.log("没有炸弹了")}},onPauseBtnTap:function(){cc.director.isPaused()?this.resumeAction():this.pauseAction()},resumeAction:function(){this.pause.normalSprite=this.btnSprite[0],cc.director.resume(),this.gameMusic.resume()},pauseAction:function(){var e=this,t=cc.instantiate(this.pausedlPrefab);t.getComponent("pausedlViewManager").setCb(function(){cc.director.resume(),e.gameMusic.resume(),e.pause.normalSprite=e.btnSprite[0]}),this.mianNode.addChild(t),this.gameMusic.pause()},gainScore:function(e){if(this.score+=e,this.scoreDisplay.string=this.score.toString(),D.curStage>0&&D.curStage<=3){if(this.eState==D.commonInfo.gameState.pause)return;var t=parseInt(D.stage[D.curStage].scoreMax*D.curDifficult);this.score>=t&&this.goToNextStage()}},goToNextStage:function(){cc.log("goToNextStage1"),this.eState=D.commonInfo.gameState.pause,D.curScore=this.scoreDisplay.string,this.removeEnemy(),this.enemyGroup.pauseAction(),this.bulletGroup.pauseAction(),this.hero.offDrag(),this.ufoGroup.pauseAction();var e=cc.sequence(cc.fadeOut(1),cc.callFunc(function(){cc.director.loadScene("NextStageLoaing")}));this.mianNode.runAction(e)},getScore:function(){return parseInt(this.scoreDisplay.string)},updateScore:function(){var e=this.scoreDisplay.string,t={score:e,time:D.common.timeFmt(new Date,"yyyy-MM-dd hh:mm:ss")},i=cc.sys.localStorage.getItem("score"),n=cc.sys.localStorage.getItem("topScore");(!n||parseInt(n)<parseInt(e))&&cc.sys.localStorage.setItem("topScore",e),i?(i=JSON.parse(i),i instanceof Array||(i=[]),i.unshift(t)):(i=[],i.unshift(t)),cc.sys.localStorage.setItem("currentScore",e),cc.sys.localStorage.setItem("score",JSON.stringify(i))},removeEnemy:function(){var e=this;this.bombMash.scale=.5,this.bombMash.active=!0;var t=cc.callFunc(function(){e.bombMash.active=!1});this.bombMash.runAction(cc.sequence(cc.scaleTo(1,1),t)),D.isOnSound&&cc.audioEngine.playEffect(this.useBombClip,!1)},getUfoBomb:function(){parseInt(this.bombNoDisplay.string)<3&&(this.bombNoDisplay.string+=1)},gameOver:function(){0==D.curStage?this.updateScore():D.curScore=this.scoreDisplay.string,cc.director.loadScene("end")}}),cc._RFpop()},{bulletGroup:"bulletGroup",enemyGroup:"enemyGroup",hero:"hero",ufoGroup:"ufoGroup"}],nextStageLoading:[function(e,t,i){"use strict";cc._RFpush(t,"14e31KfLVdEeIx5t1sFjZkI","nextStageLoading"),cc.Class({"extends":cc.Component,properties:{stageTextLabel:{"default":null,type:cc.Label},scoreTextLabel:{"default":null,type:cc.Label},goToMainViewBtnNode:cc.Node,goToStarViewBtnNode:cc.Node,countdownClip:cc.AudioClip,missionCompleteClip:cc.AudioClip},onLoad:function(){this.goToNextStage()},goToNextStage:function(){if(cc.log("goToNextStage2"),this.scoreTextLabel.string+="\n"+D.curScore,3==D.curStage)return D.isOnSound&&cc.audioEngine.playEffect(this.missionCompleteClip,!1),this.stageTextLabel.string="恭喜你通过了第"+D.curStage+"关",this.goToMainViewBtnNode.active=!0,void(this.goToStarViewBtnNode.active=!0);this.stageTextLabel.string="恭喜你通过了第"+D.curStage+"关\n接下来是第"+(D.curStage+1)+"关";var e=3;this.scheduleOnce(function(){D.isOnSound&&cc.audioEngine.playEffect(this.countdownClip,!1)}.bind(this),1),this.schedule(function(){this.stageTextLabel.string=e,e--}.bind(this),1,3,1),this.scheduleOnce(function(){D.curStage++,cc.director.loadScene("main")}.bind(this),5)},onGoToMainViewBtnTap:function(){D.curStage=1,cc.director.loadScene("main")},onGoToStartViewBtnTap:function(){D.curStage=0,cc.director.loadScene("start")}}),cc._RFpop()},{}],pausedlViewManager:[function(e,t,i){"use strict";cc._RFpush(t,"51e290N3mdC+pqlwbigrZV4","pausedlViewManager"),cc.Class({"extends":cc.Component,properties:{main:cc.Node},onLoad:function(){this.onTouchEvent()},start:function(){cc.director.pause()},setCb:function(e){this.cb=e},onBtnTap:function(e){var t=e.target._name;switch(t){case"Btn_1":this.onResumeGame();break;case"Btn_2":this.onRestart();break;case"Btn_3":this.onReturnMenu()}},onResumeGame:function(){this.node.destroy(),this.cb()},onRestart:function(){cc.director.resume(),cc.director.loadScene("main")},onReturnMenu:function(){cc.director.resume(),cc.director.loadScene("start")},onTouchEvent:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){return e.stopPropagation(),!0},this.node)}}),cc._RFpop()},{}],scoreItemTemplate:[function(e,t,i){"use strict";cc._RFpush(t,"e7aaajpGBdAAaGaUimU4MnH","scoreItemTemplate"),cc.Class({"extends":cc.Component,properties:{itemScore:cc.Label,itemTime:cc.Label,rankLabel:cc.Label},onLoad:function(){},init:function(e){this.rankLabel.string="排名："+e.rank,this.itemScore.string="积分："+e.score,this.itemTime.string="时间："+e.time}}),cc._RFpop()},{}],settingsViewManager:[function(e,t,i){"use strict";cc._RFpush(t,"20bb6yxJJlAHLpCM8CpMfwy","settingsViewManager"),cc.Class({"extends":cc.Component,properties:{main:cc.Node,bgmTextLabel:cc.Label,soundTextLabel:cc.Label,bgmToggle:{"default":null,type:cc.Toggle},soundToggle:{"default":null,type:cc.Toggle},difficultToggleList:{"default":[],type:cc.Toggle}},onLoad:function(){this.onTouchEvent(),this.setDifficultToggle(),this.switchList=["关闭","开启"],this.bgmToggle.isChecked=D.isOnBgm,this.setBgmTextLabel(),this.soundToggle.isChecked=D.isOnSound,this.setSoundTextLabel()},init:function(e){this.gameMusic=e},onBgmSwitch:function(e){D.isOnBgm=e.isChecked,this.setBgmTextLabel(),D.isOnBgm?this.gameMusic.mute=!1:this.gameMusic.mute=!0},onSoundSwitch:function(e){D.isOnSound=e.isChecked,this.setSoundTextLabel()},setBgmTextLabel:function(){this.bgmTextLabel.string="背景音乐-"+this.switchList[D.isOnBgm?1:0]},setSoundTextLabel:function(){this.soundTextLabel.string="特效音乐-"+this.switchList[D.isOnSound?1:0]},setDifficultToggle:function(){for(var e in this.difficultToggleList)this.difficultToggleList[e].isChecked=!1,0==e&&.5==D.curDifficult&&(this.difficultToggleList[e].isChecked=!0),1==e&&1==D.curDifficult&&(this.difficultToggleList[e].isChecked=!0),2==e&&2==D.curDifficult&&(this.difficultToggleList[e].isChecked=!0)},setDifficult_1:function(){D.curDifficult=.5},setDifficult_2:function(){D.curDifficult=1},setDifficult_3:function(){D.curDifficult=2},onTouchEvent:function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(t){return t.stopPropagation(),e.node.destroy(),!0},this.node),this.main.on(cc.Node.EventType.TOUCH_START,function(e){return e.stopPropagation(),!0},this)}}),cc._RFpop()},{}],start:[function(e,t,i){"use strict";cc._RFpush(t,"280c3rsZJJKnZ9RqbALVwtK","start"),cc.Class({"extends":cc.Component,properties:{game_loading:cc.Node,rankPrefab:cc.Prefab,levelView:cc.Prefab,settingsView:cc.Prefab,gameMusic:{"default":null,type:cc.AudioSource}},onLoad:function(){cc.director.isPaused()&&cc.director.resume();var e=this.game_loading.getComponent(cc.Animation);e.play(),D.isOnBgm&&this.gameMusic.play(),cc.director.preloadScene("main")},onGotoLevelViewBtnTap:function(){var e=cc.instantiate(this.levelView);this.node.addChild(e)},startGame:function(){D.curStage=0,cc.director.loadScene("main")},onSettingViewBtnTap:function(){var e=cc.instantiate(this.settingsView);e.getComponent("settingsViewManager").init(this.gameMusic),this.node.addChild(e)},gotoHistoryScore:function(){var e=cc.instantiate(this.rankPrefab);this.node.addChild(e)},exitGame:function(){cc.game.end()}}),cc._RFpop()},{}],ufoGroup:[function(e,t,i){"use strict";cc._RFpush(t,"07c58NeAQVELrP3L2RCOyrA","ufoGroup");var n=cc.Class({name:"ufoG",properties:{name:"",freqTime:0,prefab:cc.Prefab,initPoolCount:0,minDelay:{"default":0,tooltip:"最小延迟"},maxDelay:{"default":0,tooltip:"最大延迟"}}});cc.Class({"extends":cc.Component,properties:{ufoG:{"default":[],type:n}},onLoad:function(){this.eState=D.commonInfo.gameState.none;for(var e in this.ufoG)D.common.createPool({name:this.ufoG[e].name+"Pool",mediator:"ufo",prefab:this.ufoG[e].prefab,initCount:this.ufoG[e].initPoolCount})},resumeAction:function(){this.enabled=!0,this.eState=D.commonInfo.gameState.start},pauseAction:function(){this.enabled=!1,this.eState=D.commonInfo.gameState.pause},startAction:function(){this.eState=D.commonInfo.gameState.start;for(var e=0;e<this.ufoG.length;++e){var t=this.ufoG[e].freqTime;this.schedule(function(e){this.randNewUfo(this.ufoG[e])}.bind(this,e),t)}},randNewUfo:function(e){var t=Math.random()*(e.maxDelay-e.minDelay)+e.minDelay;this.scheduleOnce(function(e){this.getNewUfo(e)}.bind(this,e),t)},getNewUfo:function(e){var t=e.name+"Pool",i=D.common.getPoolObj(t),n=this.getNewUfoPositon(i);i.setPosition(n),i.getComponent("ufo").setUfoPoolName(t),this.node.addChild(i)},getNewUfoPositon:function(e){var t=cc.randomMinus1To1()*(this.node.parent.width/2-e.width/2),i=this.node.parent.height/2+e.height/2;return cc.v2(t,i)},ufoDied:function(e,t){D.common.putPoolObj(t,e)}}),cc._RFpop()},{}],ufo:[function(e,t,i){"use strict";cc._RFpush(t,"1e7a0zfIuJA+Kn9DAfY5544","ufo"),cc.Class({"extends":cc.Component,properties:{xMinSpeed:{"default":0,type:cc.Integer},xMaxSpeed:{"default":0,type:cc.Integer},yMinSpeed:{"default":0,type:cc.Integer},yMaxSpeed:{"default":0,type:cc.Integer},getUfoClip:cc.AudioClip,changeSprList:{"default":[],type:cc.SpriteFrame}},onLoad:function(){cc.director.getCollisionManager().enabled=!0,this.changeSprList&&(this.changeNum=0,this.schedule(this.changeSprAni,.5)),this.xSpeed=Math.random()*(this.xMaxSpeed-this.xMinSpeed)+this.xMinSpeed,this.ySpeed=cc.random0To1()*(this.yMaxSpeed-this.yMinSpeed)+this.yMinSpeed,this.ufoGroup=this.node.parent.getComponent("ufoGroup")},changeSprAni:function(){for(var e=0;e<this.changeSprList.length;e++)e==this.changeNum&&(this.node.getComponent(cc.Sprite).spriteFrame=this.changeSprList[e]);4==this.changeNum?this.changeNum=0:this.changeNum++},setUfoPoolName:function(e){this.ufoPoolName=e},onCollisionEnter:function(e,t){D.isOnSound&&cc.audioEngine.playEffect(this.getUfoClip,!1),this.ufoGroup.ufoDied(t.node,this.ufoPoolName)},update:function(e){this.ufoGroup.eState==D.commonInfo.gameState.start&&(this.node.x+=e*this.xSpeed,this.node.y+=e*this.ySpeed,this.node.y<-this.node.parent.height/2&&this.ufoGroup.ufoDied(this.node,this.ufoPoolName))}}),cc._RFpop()},{}]},{},["AdaptationScene","background","bullet","bulletGroup","common","end","enemy","enemyBullet","enemyBulletGroup","enemyGroup","globals","hero","historyScore","levelView","main","nextStageLoading","pausedlViewManager","scoreItemTemplate","settingsViewManager","start","ufo","ufoGroup"]);